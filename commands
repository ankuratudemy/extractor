aws ecr get-login-password --region eu-west-2 | docker login --username AWS --password-stdin 358775306462.dkr.ecr.eu-west-2.amazonaws.com
docker build --platform linux/arm64 --progress=plain -t extractor-init-aks .
Or for amd64 build
docker build --platform linux/amd64 --progress=plain -t extractor-lambda .
docker tag extractor:latest 358775306462.dkr.ecr.eu-west-2.amazonaws.com/extractor-lambda:latest
docker push 358775306462.dkr.ecr.eu-west-2.amazonaws.com/extractor-lambda:latest

docker build --build-arg="TIKA_VERSION=2.9.1" --platform linux/amd64 --progress=plain -t extractor-tika-server -f dockerfile-tika-server .

docker run --platform linux/amd64 -p 127.0.0.1:9998:9998 extractor-tika-server:latest


RUN Locally :

amd64 build:

mkdir -p ~/.aws-lambda-rie && \
    curl -Lo ~/.aws-lambda-rie/aws-lambda-rie https://github.com/aws/aws-lambda-runtime-interface-emulator/releases/latest/download/aws-lambda-rie && \
    chmod +x ~/.aws-lambda-rie/aws-lambda-rie

arm64 build: 

mkdir -p ~/.aws-lambda-rie && \
    curl -Lo ~/.aws-lambda-rie/aws-lambda-rie https://github.com/aws/aws-lambda-runtime-interface-emulator/releases/latest/download/aws-lambda-rie-arm64 && \
    chmod +x ~/.aws-lambda-rie/aws-lambda-rie


Run container lcoally:

docker run --platform linux/arm64 -d -v ~/.aws-lambda-rie:/aws-lambda -p 8080:8080 \
    --name extractor-lambda \
    --entrypoint /aws-lambda/aws-lambda-rie \
    --tty --interactive \
    --detach=false \
    extractor-lambda:latest \
        /usr/local/bin/python -m awslambdaric lambda_function.handler

docker run --platform linux/amd64 -d -v ~/.aws-lambda-rie:/aws-lambda -p 9000:8080 \
    --entrypoint /aws-lambda/aws-lambda-rie \
    --name extractor-lambda \
    --tty --interactive \
    --detach=false \
    extractor-lambda:1.0.0 \
        /usr/local/bin/python -m awslambdaric lambda_function.handler


Create execution role:

aws iam create-role --role-name lambda-ex --assume-role-policy-document '{"Version": "2012-10-17","Statement": [{ "Effect": "Allow", "Principal": {"Service": "lambda.amazonaws.com"}, "Action": "sts:AssumeRole"}]}'

aws lambda create-function \
  --function-name extractor \
  --package-type Image \
  --code ImageUri=358775306462.dkr.ecr.eu-west-2.amazonaws.com/extractor-lambda:latest \
  --role arn:aws:iam::358775306462:role/lambda-ex

  aws lambda update-function \
  --function-name extractor \
  --package-type Image \
  --code ImageUri=358775306462.dkr.ecr.eu-west-2.amazonaws.com/extractor-lambda:latest \
  --role arn:aws:iam::358775306462:role/lambda-ex

Signature issue:
kill running container then:

docker image prune -f

docker container prune -f




DO not have enough space in arhcive:


docker system prune