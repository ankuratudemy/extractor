gcloud services enable apigateway.googleapis.com
gcloud services enable servicemanagement.googleapis.com
gcloud services enable servicecontrol.googleapis.com


$ServiceAccountName = "xtract-fe-service-account"

# Create a service account
gcloud iam service-accounts create $ServiceAccountName `
    --project $PROJECT_ID

Download key json file from console- > ervcie accpunts optoins --> manage key
$ServiceAccountKeyPathFE = ".\SAKeys\fe-key.json"


# Print the email address of the service accounts
$ServiceAccountEmail = gcloud iam service-accounts list `
    --project $PROJECT_ID `
    --format="value(email)"
Write-Host "Service Account Email: $ServiceAccountEmail"


# Assign roles to the service account

gcloud projects add-iam-policy-binding $PROJECT_ID `
    --member="serviceAccount:xtract-fe-service-account@structhub-412620.iam.gserviceaccount.com" `
    --role="roles/run.invoker"
	
gcloud projects add-iam-policy-binding $PROJECT_ID `
    --member="serviceAccount:xtract-fe-service-account@structhub-412620.iam.gserviceaccount.com" `
    --role="roles/iam.serviceAccountTokenCreator"


#Service Account Email:
 xtract-fe-service-account@structhub-412620.iam.gserviceaccount.com


# Activate the service account
gcloud auth activate-service-account --key-file=$ServiceAccountKeyPathFE


#Generate token:

 gcloud auth print-identity-token --audiences "$STRUCTHUB_DOMAIN_BE"
 
 
 
 # Go back to owener user shell:
 
 gcloud config set account  support@structhub.io
 
 
 
 # can list all avaialble accounts:
 
  gcloud auth list
  
  
  